# 10.5 やり直し

```
goh@goh ~/s/g/u/enjoyable_ruby> time ruby 10.5/retry.rb 10.5/NEWS-2.6.0
"# -*- rdoc -*-\n\n= NEWS for Ruby 2.6.0\n\nThis document is a list of user visible feature changes made between\nreleases except for bug fixes.\n\nNote that each entry is kept so brief that no reason behind or reference\ninformation is supplied with.  For a full list of changes with all\nsufficient information, see the ChangeLog file or Redmine\n(e.g. <tt>https://bugs.ruby-lang.org/issues/$FEATURE_OR_BUG_NUMBER</tt>)\n\n== Changes since the 2.5.0 release\n\n=== Language changes\n\n* <code>$SAFE</code> now is a process global state and can be set to 0 again. [Feature #14250]\n\n* Refinements take place at block passing.  [Feature #14223]\n\n* Refinements take place at Kernel#public_send.  [Feature #15326]\n\n* Refinements take place at Kernel#respond_to?.  [Feature #15327]\n\n* +else+ without +rescue+ now causes a syntax error.  [EXPERIMENTAL] [Feature #14606]\n\n* Constant names may start with a non-ASCII capital letter. [Feature #13770]\n\n* Endless ranges are introduced.  You can use a Range that has no end,\n  like <code>(0..)</code> (or similarly <code>(0...)</code>).  [Feature #12912]\n\n  The following shows typical use cases:\n\n    ary[1..]                              # identical to ary[1..-1]\n    (1...).each {|index| block }          # infinite loop from index 1\n    ary.zip(1..) {|elem, index| block }   # ary.each.with_index(1) { }\n\n* Non-Symbol keys in a keyword arguments hash cause an exception.\n\n* The \"shadowing outer local variable\" warning is removed.  [Feature #12490]\n\n  You can now write the following without warning:\n\n    user = users.find {|user| cond(user) }\n\n* Print +cause+ of the exception if the exception is not caught and printed\n  its backtraces and error message. [Feature #8257]\n\n* The flip-flop syntax is deprecated. [Feature #5400]\n\n=== Core classes updates (outstanding ones only)\n\nArray::\n\n  New methods::\n\n    * Added Array#union and Array#difference instance methods.  [Feature #14097]\n\n  Modified method::\n\n    * Array#to_h now accepts a block that maps elements to new key/value pairs.  [Feature #15143]\n\n  Aliased methods::\n\n    * Array#filter is a new alias for Array#select. [Feature #13784]\n    * Array#filter! is a new alias for Array#select!. [Feature #13784]\n\nBinding::\n\n  New method::\n\n    * Added Binding#source_location.  [Feature #14230]\n\n      This method returns the source location of the binding, a 2-element\n      array of <code>__FILE__</code> and <code>__LINE__</code>.\n      Traditionally, the same information could be retrieved by\n      <code>eval(\"[__FILE__, __LINE__]\", binding)</code>, but we are\n      planning to change this behavior so that Kernel#eval ignores\n      binding's source location [Bug #4352].  So, users should use this\n      newly-introduced method instead of Kernel#eval.\n\nDir::\n\n  New methods::\n\n    * Added Dir#each_child and Dir#children instance methods. [Feature #13969]\n\nEnumerable::\n\n  New method::\n\n    * Enumerable#chain returns an enumerator object that iterates over the\n      elements of the receiver and then those of each argument\n      in sequence.  [Feature #15144]\n\n  Modified method::\n\n    * Enumerable#to_h now accepts a block that maps elements to new key/value pairs.  [Feature #15143]\n\n  Aliased method::\n\n    * Enumerable#filter is a new alias for Enumerable#select. [Feature #13784]\n\nEnumerator::ArithmeticSequence::\n\n  * This is a new class to represent a generator of an arithmetic sequence,\n    that is a number sequence defined by a common difference. It can be used\n    for representing what is similar to Python's slice. You can get an\n    instance of this class from Numeric#step and Range#step.\n\nEnumerator::Chain::\n\n  * This is a new class to represent a chain of enumerables that works as a\n    single enumerator, generated by such methods as Enumerable#chain and\n    Enumerator#+.\n\nEnumerator::Lazy::\n\n  Aliased method::\n\n    * Enumerator::Lazy#filter is a new alias for\n      Enumerator::Lazy#select.  [Feature #13784]\n\nEnumerator::\n\n  New methods::\n\n    * Enumerator#+ returns an enumerator object that iterates over the\n      elements of the receiver and then those of the other operand.  [Feature #15144]\n\nENV::\n\n  Modified method::\n\n    * ENV.to_h now accepts a block that maps names and values to new keys and values.  [Feature #15143]\n\nException::\n\n  New options::\n\n    * Exception#full_message takes +:highlight+ and +:order+\n      options. [Bug #14324]\n\nHash::\n\n  Modified methods::\n\n    * Hash#merge, Hash#merge!, and Hash#update now accept multiple\n      arguments.  [Feature #15111]\n\n    * Hash#to_h now accepts a block that maps keys and values to new keys and values.  [Feature #15143]\n\n  Aliased methods::\n\n    * Hash#filter is a new alias for Hash#select.  [Feature #13784]\n\n    * Hash#filter! is a new alias for Hash#select!. [Feature #13784]\n\nIO::\n\n  New option::\n\n    * Added new mode character <code>'x'</code> to open files for exclusive\n      access. [Feature #11258]\n\nKernel::\n\n  Aliased method::\n\n    * Kernel#then is a new alias for Kernel#yield_self. [Feature #14594]\n\n  New options::\n\n    * Kernel#Complex, Kernel#Float, Kernel#Integer, and\n      Kernel#Rational take an +:exception+ option to specify the way of\n      error handling.  [Feature #12732]\n\n    * Kernel#system takes an +:exception+ option to raise an exception\n      on failure.  [Feature #14386]\n\n  Incompatible changes::\n\n    * Kernel#system and Kernel#exec do not close non-standard file descriptors\n      (the default of the +:close_others+ option is changed to +false+,\n      but we still set the +FD_CLOEXEC+ flag on descriptors we\n      create).  [Misc #14907]\n\nKeyError::\n\n  New options::\n\n    * KeyError.new accepts +:receiver+ and +:key+ options to set receiver and\n      key in Ruby code.  [Feature #14313]\n\nMethod::\n\n  New methods::\n\n    * Added Method#<< and Method#>> for Proc composition.  [Feature #6284]\n\nModule::\n\n  Modified methods::\n\n    * Module#method_defined?, Module#private_method_defined?, and\n      Module#protected_method_defined? now accept the second\n      parameter as optional. If it is +true+ (the default value), it checks\n      ancestor modules/classes, or checks only the class itself. [Feature #14944]\n\nNameError::\n\n  New option::\n\n    * NameError.new accepts a +:receiver+ option to set receiver in Ruby\n      code.  [Feature #14313]\n\nNilClass::\n\n  New method::\n\n    * NilClass#=~ is added for compatibility.  [Feature #15231]\n\nNoMethodError::\n\n  New option::\n\n    * NoMethodError.new accepts a +:receiver+ option to set receiver in Ruby\n      code.  [Feature #14313]\n\nNumeric::\n\n  Incompatible changes::\n\n    * Numeric#step now returns an instance of the Enumerator::ArithmeticSequence\n      class rather than one of the Enumerator class.\n\nOpenStruct::\n\n  Modified method::\n\n    * OpenStruct#to_h now accepts a block that maps keys and values to new keys and values.  [Feature #15143]\n\nProc::\n\n  New methods::\n\n    * Added Proc#<< and Proc#>> for Proc composition.  [Feature #6284]\n\n  Incompatible changes::\n\n    * Proc#call doesn't change <code>$SAFE</code> any more.  [Feature #14250]\n\nRandom::\n\n  New method::\n\n    * Added Random.bytes.  [Feature #4938]\n\nRange::\n\n  New method::\n\n    * Added Range#% instance method.  [Feature #14697]\n\n  Incompatible changes::\n\n    * Range#=== now uses the +#cover?+ instead of the +#include?+ method. [Feature #14575]\n    * Range#cover? now accepts a Range object. [Feature #14473]\n    * Range#step now returns an instance of the Enumerator::ArithmeticSequence\n      class rather than one of the Enumerator class.\n\nRegexp/String::\n\n    * Update Unicode version from 10.0.0 to 11.0.0. [Feature #14802]\n\n      This includes a rewrite of the grapheme cluster (/\\X/) algorithm\n      and special-casing for Georgian MTAVRULI on String#downcase.\n\n    * Update Emoji version from 5.0 to 11.0.0 [Feature #14802]\n\nRubyVM::AbstractSyntaxTree::\n\n  New methods::\n\n    * RubyVM::AbstractSyntaxTree.parse parses a given string and returns AST\n      nodes. [experimental]\n\n    * RubyVM::AbstractSyntaxTree.parse_file parses a given file and returns AST\n      nodes.  [experimental]\n\n    * RubyVM::AbstractSyntaxTree.of returns AST nodes of the given proc or\n      method.  [experimental]\n\nRubyVM::\n\n  New method::\n\n    * RubyVM.resolve_feature_path identifies the file that will be loaded by\n      \"require(feature)\". [experimental] [Feature #15230]\n\nString::\n\n  * String#crypt is now deprecated. [Feature #14915]\n\n  New features::\n\n    * String#split yields each substring to the block if given. [Feature #4780]\n\nStruct::\n\n  Modified method::\n\n    * Struct#to_h now accepts a block that maps keys and values to new keys and values.  [Feature #15143]\n\n  Aliased method::\n\n    * Struct#filter is a new alias for Struct#select. [Feature #13784]\n\nTime::\n\n  New features::\n\n    * Time.new and Time#getlocal accept a timezone object as well as\n      a UTC offset string. Time#+, Time#-, and Time#succ also preserve\n      the timezone.  [Feature #14850]\n\nTracePoint::\n\n  New features::\n\n    * \"script_compiled\" event is supported. [Feature #15287]\n\n  New methods::\n\n    * TracePoint#parameters [Feature #14694]\n\n    * TracePoint#instruction_sequence [Feature #15287]\n\n    * TracePoint#eval_script [Feature #15287]\n\n  Modified method::\n\n    * TracePoint#enable accepts new keywords \"target:\" and\n      \"target_line:\".  [Feature #15289]\n\n=== Stdlib updates (outstanding ones only)\n\nBigDecimal::\n\n  Update to version 1.4.0.  This version includes several compatibility\n  issues, see Compatibility issues section below for details.\n\n  Modified method::\n\n    * BigDecimal() accepts the new keyword \"exception:\" similar to Float().\n\n  Note for the differences among recent versions::\n\n    You should want to know the differences among recent versions of bigdecimal.\n    Please select the suitable version of bigdecimal according to the following\n    information.\n\n    * 1.3.5 has BigDecimal.new without \"exception:\" keyword.  You can see the\n      deprecation warning of BigDecimal.new when you specify \"-w\" option.\n      BigDecimal(), BigDecimal.new, and Object#to_d methods are the same.\n\n    * 1.4.0 has BigDecimal.new with \"exception:\" keyword.  You always see the\n      deprecation warning of BigDecimal.new.  Object#to_d method is different\n      from BigDecimal() and BigDecimal.new.\n\n    * 2.0.0 will be released soon after releasing Ruby 2.6.0.  This version\n      will not have the BigDecimal.new method.\n\nBundler::\n\n  * Add Bundler to Standard Library. [Feature #12733]\n\n  * Use 1.17.2, the latest stable version.\n\nCoverage::\n\n  A oneshot_lines mode is added.  [Feature #15022]\n\n  This mode checks \"whether each line was executed at least once or not\",\n  instead of \"how many times each line was executed\".\n  A hook for each line is fired at most once, and after it is fired\n  the hook flag is removed, i.e., it runs with zero overhead.\n\n  New options::\n\n    * Add +:oneshot_lines+ keyword argument to Coverage.start.\n\n    * Add +:stop+ and +:clear+ keyword arguments to Coverage.result.\n      If +clear+ is true, it clears the counters to zero.\n      If +stop+ is true, it disables coverage measurement.\n\n  New methods::\n\n    * Coverage.line_stub, which is a simple helper function that\n      creates the \"stub\" of line coverage from a given source code.\n\nCSV::\n\n  * Upgrade to 3.0.2. This includes performance improvements especially\n    for writing. Writing is about 2 times faster.\n    See https://github.com/ruby/csv/blob/master/NEWS.md.\n\nERB::\n\n  New options::\n\n    * Add +:trim_mode+ and +:eoutvar+ keyword arguments to ERB.new.\n      Now non-keyword arguments other than the first one are softly deprecated\n      and will be removed when Ruby 2.5 becomes EOL. [Feature #14256]\n\n    * erb command's <tt>-S</tt> option is deprecated, and will be removed\n      in the next version.\n\nFileUtils::\n\n  New methods::\n\n    * FileUtils#cp_lr.  [Feature #4189]\n\nMatrix::\n\n  New methods::\n\n    * Matrix#antisymmetric?, Matrix#skew_symmetric?\n\n    * Matrix#map!, Matrix#collect! [Feature #14151]\n\n    * Matrix#[]=\n\n    * Vector#map!, Vector#collect!\n\n    * Vector#[]=\n\nNet::\n\n  New options::\n\n    * Add +:write_timeout+ keyword argument to Net::HTTP.new. [Feature #13396]\n\n  New methods::\n\n    * Add Net::HTTP#write_timeout and Net::HTTP#write_timeout=.  [Feature #13396]\n\n  New constant::\n\n    * Add Net::HTTPClientException to deprecate Net::HTTPServerException,\n      whose name is misleading.  [Bug #14688]\n\nNKF::\n\n  * Upgrade to nkf v2.1.5\n\nPsych::\n\n  * Upgrade to Psych 3.1.0\n\nRDoc::\n\n  * Become about 2 times faster.\n\n  * Use SOURCE_DATE_EPOCH to generate files.\n\n  * Fix method line number that slipped off.\n\n  * Enable <code>--width</code>, <code>--exclude</code>,\n    and <code>--line-numbers</code> that were ignored.\n\n  * Add support for blockquote by \">>>\" in default markup notation.\n\n  * Add support for \"Raises\" lines in TomDoc notation.\n\n  * Fix syntax error output.\n\n  * Fix many parsing bugs.\n\nREXML::\n\n  * Upgrade to REXML 3.1.9.\n    See https://github.com/ruby/rexml/blob/master/NEWS.md.\n\n  Improved some XPath implementations::\n\n    * <code>concat()</code> function: Stringify all arguments before concatenating.\n\n    * <code>string()</code> function: Support context node.\n\n    * <code>string()</code> function: Support processing instruction node.\n\n    * Support <code>\"*:\#{ELEMENT_NAME}\"</code> syntax in XPath 2.0.\n\n  Fixed some XPath implementations::\n\n    * <code>\"//\#{ELEMENT_NAME}[\#{POSITION}]\"</code> case\n\n    * <code>string()</code> function: Fix <code>function(document)</code>\n      returns nodes that are out of root elements.\n\n    * <code>\"/ \#{ELEMENT_NAME} \"</code> case\n\n    * <code>\"/ \#{ELEMENT_NAME} [ \#{PREDICATE} ]\"</code> case\n\n    * <code>\"/ \#{AXIS}::\#{ELEMENT_NAME}\"</code> case\n\n    * <code>\"\#{N}-\#{M}\"</code> case: One or more white spaces were required\n      before <code>\"-\"</code>\n\n    * <code>\"/child::node()\"</code> case\n\n    * <code>\"\#{FUNCTION}()/\#{PATH}\"</code> case\n\n    * <code>\"@\#{ATTRIBUTE}/parent::\"</code> case\n\n    * <code>\"name(\#{NODE_SET})\"</code> case\n\nRSS::\n\n  New options::\n\n    * RSS::Parser.parse now accepts options as Hash. +:validate+ ,\n      +:ignore_unknown_element+ , +:parser_class+ options are available.\n\nRubyGems::\n\n  * Upgrade to RubyGems 3.0.1\n\n  * https://blog.rubygems.org/2018/12/19/3.0.0-released.html\n\n  * https://blog.rubygems.org/2018/12/23/3.0.1-released.html\n\nSet::\n\n  Aliased method::\n\n    * Set#filter! is a new alias for Set#select!.  [Feature #13784]\n\nURI::\n\n  New constant::\n\n    * Add URI::File to handle the file URI scheme.  [Feature #14035]\n\n=== Compatibility issues (excluding feature bug fixes)\n\nDir::\n\n  * Dir.glob with <code>'\\0'</code>-separated pattern list will be deprecated,\n    and is now warned.  [Feature #14643]\n\nFile::\n\n  * File.read, File.binread, File.write, File.binwrite, File.foreach, and\n    File.readlines do not invoke external commands even if the path starts\n    with the pipe character <code>'|'</code>. [Feature #14245]\n\nObject::\n\n  * Object#=~ is deprecated.  [Feature #15231]\n\n=== Stdlib compatibility issues (excluding feature bug fixes)\n\n* These standard libraries have been promoted to default gems.\n\n  * e2mmap\n  * forwardable\n  * irb\n  * logger\n  * matrix\n  * mutex_m\n  * ostruct\n  * prime\n  * rexml\n  * rss\n  * shell\n  * sync\n  * thwait\n  * tracer\n\nBigDecimal::\n\n  * The following methods are removed.\n\n    * BigDecimal.allocate\n    * BigDecimal.ver\n\n  * Every BigDecimal object is frozen. [Feature #13984]\n\n  * BigDecimal() parses the given string similar to Float().\n\n  * String#to_d parses the receiver string similar to String#to_f.\n\n  * BigDecimal.new will be removed in version 2.0.\n\nPathname::\n\n  * Pathname#read, Pathname#binread, Pathname#write, Pathname#binwrite,\n    Pathname#each_line and Pathname#readlines do not invoke external\n    commands even if the path starts with the pipe character <code>'|'</code>.\n    This follows [Feature #14245].\n\n=== Implementation improvements\n\n* Speedup Proc#call because we don't need to care about <code>$SAFE</code>\n  any more. [Feature #14318]\n\n  With +lc_fizzbuzz+ benchmark which uses Proc#call many times we can\n  measure x1.4 improvements.  [Bug #10212]\n\n* Speedup block.call where +block+ is passed block parameter. [Feature #14330]\n\n  Ruby 2.5 improves block passing performance. [Feature #14045]\n\n  Additionally, Ruby 2.6 improves the performance of passed block calling.\n\n* Introduce an initial implementation of a JIT (Just-in-time) compiler. [Feature #14235] [experimental]\n\n  * <tt>--jit</tt> command line option is added to enable JIT. <tt>--jit-verbose=1</tt>\n    is good for inspection.  See <tt>ruby --help</tt> for others.\n  * To generate machine code, this JIT compiler uses the C compiler used for building\n    the interpreter. Currently GCC, Clang, and Microsoft Visual C++ are supported for it.\n  * <tt>--disable-mjit-support</tt> option is added to configure. This is added for JIT debugging,\n    but if you get an error on building a header file for JIT, you can use this option to skip\n    building it as a workaround.\n  * rb_waitpid reimplemented on Unix-like platforms to maintain\n    compatibility with processes created for JIT [Bug #14867]\n\n* VM generator script renewal; makes the generated VM more optimized. [GH-1779]\n\n* Thread cache enabled for pthreads platforms (for Thread.new and\n  Thread.start).  [Feature #14757]\n\n* timer thread is eliminated for platforms with POSIX timers. [Misc #14937]\n\n* Transient Heap (theap) is supported. [Bug #14858] [Feature #14989]\n\n  theap is a managed heap for short-living memory objects. For example,\n  making a small and short-living Hash object is x2 faster. With rdoc benchmark,\n  we measured 6-7% performance improvement.\n\n* Native implementations (arm32, arm64, ppc64le, win32, win64, x86, amd64) of\n  coroutines to improve performance of Fiber significantly. [Feature #14739]\n\n=== Miscellaneous changes\n\n* On macOS, shared libraries no longer include a full version number of Ruby\n  in their names.  This eliminates the burden of each teeny upgrade on the\n  platform that users need to rebuild every extension library.\n\n  Before::\n    * libruby.2.6.0.dylib\n    * libruby.2.6.dylib -> libruby.2.6.0.dylib\n    * libruby.dylib -> libruby.2.6.0.dylib\n\n  After::\n    * libruby.2.6.dylib\n    * libruby.dylib -> libruby.2.6.dylib\n\n* Extracted misc/*.el files to https://github.com/ruby/elisp\n"
        0.25 real         0.10 user         0.06 sys
```

```
goh@goh ~/s/g/u/enjoyable_ruby> time ruby 10.5/retry.rb 10.5/README
"This is the README.\n"
       40.25 real         0.10 user         0.06 sys
```

上記コマンド実行中に、以下のコマンドを実行した

```
goh@goh ~/s/g/u/enjoyable_ruby> echo "This is the README." > 10.5/README
```

