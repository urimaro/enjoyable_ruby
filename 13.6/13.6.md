# 13.6 配列の主なメソッド

## 配列に要素を加える

- `a.unshift(item)` : `a` の先頭に `item` を追加する

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.unshift(0)
    => [0, 1, 2, 3, 4, 5]
    >> a
    => [0, 1, 2, 3, 4, 5]
    ```

- `a << item` : `a` の末尾に `item` を追加する

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a << 6
    => [1, 2, 3, 4, 5, 6]
    >> a
    => [1, 2, 3, 4, 5, 6]
    ```

- `a.push(item)` : `a << item` と同じ

    ```
    >> a.push(7)
    => [1, 2, 3, 4, 5, 6, 7]
    >> a
    => [1, 2, 3, 4, 5, 6, 7]
    ```

- `a.concat(b)` : `a` の末尾に `b` を連結する  
    `a` そのものが変化する

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.concat([8, 9])
    => [1, 2, 3, 4, 5, 8, 9]
    >> a
    => [1, 2, 3, 4, 5, 8, 9]
    ```

- `a + b` : `a` の末尾に `b` を連結した配列を返す  
    `a` は変化しない

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a + [8, 9]
    => [1, 2, 3, 4, 5, 8, 9]
    >> a
    => [1, 2, 3, 4, 5]
    ```

- `a[n] = item` : インデックス `n` の要素を `item` に置き換える
- `a[n..m] = item` : インデックス `n` から `m` までを `item` に置き換える

    ```
    >> a = [1, 2, 3, 4, 5, 6, 7, 8]
    => [1, 2, 3, 4, 5, 6, 7, 8]
    >> a[2..4] = 0
    => 0
    >> a
    => [1, 2, 0, 6, 7, 8]
    ```

- `a[n, len] = item` : インデックス `n` から `m` 個の要素(`a[n]` も含む)を `item` に置き換える

    ```
    >> a = [1, 2, 3, 4, 5, 6, 7, 8]
    => [1, 2, 3, 4, 5, 6, 7, 8]
    >> a[2..4] = 0
    => 0
    >> a
    => [1, 2, 0, 6, 7, 8]
    >> 
    >> a[1, 3] = 9
    => 9
    >> a
    => [1, 9, 7, 8]
    ```

## 破壊的なメソッドと `freeze`

```
>> a = [1, 2, 3, 4]
=> [1, 2, 3, 4]
>> b = a
=> [1, 2, 3, 4]
>> b.pop
=> 4
>> b
=> [1, 2, 3]
>> a
=> [1, 2, 3]
```

```
>> a = [1, 2, 3, 4]
=> [1, 2, 3, 4]
>> a.freeze
=> [1, 2, 3, 4]
>> b = a.dup
=> [1, 2, 3, 4]
>> a.pop
Traceback (most recent call last):
        5: from /Users/goh/.rbenv/versions/2.6.5/bin/irb:23:in `<main>'
        4: from /Users/goh/.rbenv/versions/2.6.5/bin/irb:23:in `load'
        3: from /Users/goh/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/irb-1.0.0/exe/irb:11:in `<top (required)>'
        2: from (irb):147
        1: from (irb):147:in `pop'
FrozenError (can't modify frozen Array)
>> b.pop
=> 4
>> b
=> [1, 2, 3]
>> a
=> [1, 2, 3, 4]
```

`freeze` で凍結したオブジェクトを元に戻す方法はない
`dup` でコピーしたオブジェクトは凍結されていない

## 配列から要素を取り除く

- `a.compact` : `a` から `nil` の要素を取り除いた配列を返す
- `a.compact!` : `a` から `nil` の要素を取り除く

    ```
    >> a = [1, nil, 3, nil, nil]
    => [1, nil, 3, nil, nil]
    >> a.compact
    => [1, 3]
    >> a
    => [1, nil, 3, nil, nil]
    >> a.compact!
    => [1, 3]
    >> a
    => [1, 3]
    ```

- `a.delete(x)` : `a` から要素 `x` を取り除く

    ```
    >> a = [1, 2, 3, 2, 1]
    => [1, 2, 3, 2, 1]
    >> a.delete(2)
    => 2
    >> a
    => [1, 3, 1]
    ```

- `a.delete_at(n)` : `a` からインデックス `n` の要素を取り除く

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.delete_at(2)
    => 3
    >> a
    => [1, 2, 4, 5]
    ```

- `a.delete_if {|item| …}` : `a` の各要素 `item` について、ブロックの実行結果が「真」だった場合、 `a` から `item` を取り除く

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.delete_if {|i| i > 3}
    => [1, 2, 3]
    >> a
    => [1, 2, 3]
    ```

- `a.reject {|item| …}` : `a` の各要素 `item` について、ブロックの実行結果が「真」だった場合、 `a` から `item` を取り除いた配列を返す

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.reject {|i| i > 3}
    => [1, 2, 3]
    >> a
    => [1, 2, 3, 4, 5]
    ```

- `a.reject {|item| …}` : `a.delete_if` と同じ
- `a.slice!(n)` : `a.delete_at(n)` と同じ
- `a.slice!(n..m)` : `a` から、インデックス `n` から `m` までの要素を取り除く
- `a.slice!(n, len)` : `a` からインデックス `n` から `len` 個の要素( `a[n]` も含む)を取り除く

    ```
    >> a.slice!(2)
    => 3
    >> a
    => [1, 2, 4, 5]
    >> 
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.slice!(1..3)
    => [2, 3, 4]
    >> a
    => [1, 5]
    >> 
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.slice!(1, 2)
    => [2, 3]
    >> a
    => [1, 4, 5]
    ```

- `a.uniq` : `a` から重複する要素を取り除いた配列を返す
- `a.uniq!` : `a` から重複する要素を取り除く

    ```
    >> a = [1, 2, 3, 4, 3, 2, 1]
    => [1, 2, 3, 4, 3, 2, 1]
    >> a.uniq!
    => [1, 2, 3, 4]
    ```

- `a.shift` : `a` から先頭の要素を取り除く

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.shift
    => 1
    >> a
    => [2, 3, 4, 5]
    ```

- `a.pop` : `a` から末尾の要素を取り除く

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.pop
    => 5
    >> a
    => [1, 2, 3, 4]
    ```

*破壊的メソッドは取り除いた要素を返す*

## 配列の要素を置き換える

- `a.collect {|item| …}` : `a` の各要素 `item` にブロックを適用し、その結果を集めて新しい配列を返す
- `a.collect! {|item| …}` : `a.collect` の破壊的メソッド
- `a.map {|item| …}` : `a.collect` と同じ
- `a.map! {|item| …}` : `a.collect!` と同じ

    ```
    >> a = [1, 2, 3, 4, 5]
    => [1, 2, 3, 4, 5]
    >> a.collect! {|item| item * 2}
    => [2, 4, 6, 8, 10]
    >> a
    => [2, 4, 6, 8, 10]
    ```

